const timerDisplay = document.querySelector('#timerDisplay');
const startButton = document.querySelector('#startButton');

function startTimer(duration) {
    let time = duration, minutes, seconds;
    const endTime = Date.now() + duration * 1000; // Calcula o tempo de término

    const timerInterval = setInterval(() => {
        const remaining = Math.round((endTime - Date.now()) / 1000);
        minutes = parseInt(remaining / 60, 10);
        seconds = parseInt(remaining % 60, 10);

        minutes = minutes < 10 ? "0" + minutes : minutes;
        seconds = seconds < 10 ? "0" + seconds : seconds;

        timerDisplay.textContent = minutes + ":" + seconds;

        // Transição de cores
        updateBackgroundColor(remaining);

        if (remaining <= 0) {
            clearInterval(timerInterval);
            flashEffect();
        }
    }, 1000);
}

function updateBackgroundColor(timeLeft) {
    let color;
    if (timeLeft > 30) {
        color = `rgba(0, 0, 139, ${timeLeft / timerDuration})`; // Azul escuro a Laranja
    } else if (timeLeft <= 30 && timeLeft > 10) {
        color = `rgba(255, 140, 0, ${timeLeft / 30})`; // Laranja
    } else {
        color = `rgba(255, 0, 0, ${timeLeft / 10})`; // Vermelho
    }
    document.body.style.backgroundColor = color;
}

function flashEffect() {
    let flashTimes = 10; // Número de vezes para piscar
    let isOn = false;
    const flashInterval = setInterval(() => {
        document.body.style.backgroundColor = isOn ? 'rgba(255, 255, 255, 1)' : 'rgba(255, 0, 0, 1)';
        isOn = !isOn;
        if (--flashTimes === 0) {
            clearInterval(flashInterval);
            document.body.style.backgroundColor = 'rgba(255, 255, 255, 1)'; // Fica branco no final
            timerDisplay.textContent = "Terminou";
        }
    }, 500);
}

startButton.addEventListener('click', () => {
    const duration = 60; // Defina a duração do timer aqui
    startTimer(duration);
});
